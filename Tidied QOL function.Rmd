---
title: "QOL function tidied"
output: html_document
date: "2024-06-14"
---


```{r}
simulate_mpox_impact <- function(m = 50, sigma = 20, threshold_mild = 10, threshold_moderate = 100, M = 1000,
                                 shape_mild = 2, scale_mild = 5, shape_moderate = 3, scale_moderate = 7,
                                 shape_severe = 4, scale_severe = 9, a_mild = 2, b_mild = 5, 
                                 a_moderate = 3, b_moderate = 4, a_severe = 5, b_severe = 2) {
#Shape and scale parameter calculation
k <- (m/sigma)^2
theta <- sigma^2/m

#Probabilities for each severity state
p_mild <- pgamma(threshold_mild, shape = k, scale = theta)
p_moderate <- pgamma(threshold_moderate, shape = k, scale = theta) - p_mild
p_severe <- 1 - pgamma(threshold_moderate, shape = k, scale = theta)
  
#Creating probability vector
probabilities <- c(p_mild, p_moderate, p_severe)
  
#Drawing sample from multinomial distribution
sample <- rmultinom(1, size = M, prob = probabilities)
  
#Extract counts for each severity state
M_mild <- sample[1]
M_moderate <- sample[2]
M_severe <- sample[3]
  
#Simulate the duration of disease for each individual in each state
duration_mild <- rgamma(M_mild, shape = shape_mild, scale = scale_mild)
duration_moderate <- rgamma(M_moderate, shape = shape_moderate, scale = scale_moderate)
duration_severe <- rgamma(M_severe, shape = shape_severe, scale = scale_severe)
  
#Simulate QoL impact caused by symptoms for each disease state
qol_reduction_mild <- rbeta(M_mild, shape1 = a_mild, shape2 = b_mild)
qol_reduction_moderate <- rbeta(M_moderate, shape1 = a_moderate, shape2 = b_moderate)
qol_reduction_severe <- rbeta(M_severe, shape1 = a_severe, shape2 = b_severe)
  
#Overall QoL reduction for each individual in each severity state
total_reduction_mild <- duration_mild * qol_reduction_mild
total_reduction_moderate <- duration_moderate * qol_reduction_moderate
total_reduction_severe <- duration_severe * qol_reduction_severe
  
#Sum all the QoL reductions to get the overall reduction in QoL
overall_qol_reduction <- sum(total_reduction_mild) + sum(total_reduction_moderate) + sum(total_reduction_severe)
  
  return(overall_qol_reduction)
}




#Simulating 1000 times
set.seed(125)
results <- replicate(1000, simulate_mpox_impact())

#Print results
cat("Summary of overall QoL reduction over 1000 simulations:\n")
print(summary(results))


```